====================
k2ksm: AUTH commands
====================

AUTH commands are used to authenticate someone to the k2ksm server.  Authentications are used for one of two things:

- To authenticate a user or administrator for the purposes of executing other commands.
- To authenticate the user, full stop.  This is mainly used when a client is passing an authentication request through to the server.  For example, when authenticating an HOTP code in order to log someone in to a server or application.

Command Format
--------------
AUTH commands have the following format::

	AUTH module username code

After the word "AUTH" comes the name of the module that is handling the authentication.  At this time, there are three authenticating modules:

- **HOTP** and **TOTP**, which accept 6- or 8-digit numeric codes.
- **YUBIOTP**, which accepts a modhex-encoded YubiOTP string.

Module names are case-sensitive.

Following the module name is the username.  The username is any string that does not include a space, and is NOT case-sensitive.  Any username provided will be lowercased before processing.

Following the username is a code.  The code provided depends on the module.

Responses
---------
If the authentication is successful, then the server will respond with an OK, and no other output before the next READY message.  If there is a problem, the response will be NOK, and an explanation will be provided before the next READY message.

The AUTH module itself will generate the following errors:

1. *username not found.*  This error is generated when the username provided does not exist.
2. *username does not use module.*  This error is generated if the user exists, but has not been set up to use the specified module for authentication.

For information on AUTH-related errors pertaining to a specific module, check this directory for files ending in the name "_auth.rst".  For example, for information on AUTH-related errors generated by the YUBIOTP module, refer to the file "YUBIOTP_auth.rst" in this directory.

Example
-------
The following example shows a successful authentication using HOTP, followed by a failed authentication using YubiOTP.

::

	Server> READY 1
	Client> AUTH HOTP smithj 2637844
	Server> OK
	Server> READY 1
	Client> AUTH YUBIOTP bellr vvhftbgkftenjkjvhcgjckuehnlvitedbellldnihcfc
	Server> NOK
	Server> {
	Server> "module": "YUBIOTP"
	Server> "code": "1"
	Server> "details": "User bellr is not associated with this token."
	Server> }
	Server> READY 1
	Client> QUIT
	Server> BYE